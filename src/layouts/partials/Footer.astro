---
import social from "@/config/social.json";

// Mapeo de ids simples -> Iconify
const iconMap: Record<string, string> = {
  instagram: "tabler:brand-instagram",
  facebook: "tabler:brand-facebook",
  twitter: "tabler:brand-twitter",
  tiktok: "tabler:brand-tiktok",
  youtube: "tabler:brand-youtube",
};
const resolveIcon = (id?: string) =>
  id?.includes(":") ? id! : (iconMap[id?.toLowerCase() || ""] || "tabler:alert-circle");

// Solo dejamos las permitidas
const allowed = new Set(["Instagram", "Facebook", "TikTok", "YouTube"]);
const socials = (social?.main ?? []).filter((s) => allowed.has(s.name));
---

<footer class="bg-light dark:bg-darkmode-light mt-16 border-t border-border dark:border-darkmode-border">
  <div class="container">
    <div class="py-10 flex flex-col md:flex-row items-center justify-between gap-6">
      
      <!-- Redes sociales -->
      <ul class="flex items-center gap-4">
        {socials.map((s) => (
          <li>
            <a
              href={s.link}
              target="_blank"
              rel="noopener noreferrer"
              aria-label={s.name}
              title={s.name}
              class="inline-flex items-center justify-center w-10 h-10 rounded-full border border-border dark:border-darkmode-border hover:bg-black/5 dark:hover:bg-white/10"
            >
              <iconify-icon icon={resolveIcon(s.icon)} width="20" height="20"></iconify-icon>
            </a>
          </li>
        ))}
      </ul>

      <!-- Copyright -->
      <p class="text-sm text-text-light dark:text-darkmode-text-light text-center md:text-right">
        Â© {new Date().getFullYear()} Obba Skate. Todos los derechos reservados.
      </p>
    </div>
  </div>

  <!-- Script fallback por si no carga Iconify desde Base -->
  <script is:inline>
    if (!customElements.get('iconify-icon')) {
      const s = document.createElement('script');
      s.src = 'https://unpkg.com/@iconify-icon/web@2.1.0/dist/iconify-icon.min.js';
      s.defer = true;
      document.head.appendChild(s);
    }
  </script>
</footer>
